<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>PokÃ©dex</title>

        <link
            rel="icon"
            type="image/png"
            href="favicon/android-chrome-512x512.png"
        />

        <meta property="og:type" content="website" />
        <meta property="og:title" content="PokÃ©dex" />
        <meta property="description" content="í¬ì¼“ëª¬ ë„ê°ë²ˆí˜¸ë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”!">
        <meta property="og:image" content="pokeball.png">

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
            rel="stylesheet"
        />

        <style>
            /* í°íŠ¸ ë° ìƒ‰ìƒ ë³€ìˆ˜ ì •ì˜ */
            :root {
                --font-pixel: "Press Start 2P", cursive;
                --font-main: "Taenada", sans-serif; /* ê¸°ì¡´ í°íŠ¸ë„ ìœ ì§€ */
                --color-primary: #e63946; /* í¬ì¼“ëª¬ ë ˆë“œë¥¼ ë©”ì¸ ì»¬ëŸ¬ë¡œ */
                --color-primary-dark: #d62828;
                --color-background: #f1faee;
                --color-card: rgba(255, 255, 255, 0.7); /* ë°˜íˆ¬ëª… ì¹´ë“œ ë°°ê²½ */
                --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            }

            /* íƒ€ì…ë³„ ìƒ‰ìƒ ë³€ìˆ˜ */
            :root {
                --type-normal: #a8a77a;
                --type-fire: #ee8130;
                --type-water: #6390f0;
                --type-electric: #f7d02c;
                --type-grass: #7ac74c;
                --type-ice: #96d9d6;
                --type-fighting: #c22e28;
                --type-poison: #a33ea1;
                --type-ground: #e2bf65;
                --type-flying: #a98ff3;
                --type-psychic: #f95587;
                --type-bug: #a6b91a;
                --type-rock: #b6a136;
                --type-ghost: #735797;
                --type-dragon: #6f35fc;
                --type-dark: #705746;
                --type-steel: #b7b7ce;
                --type-fairy: #d685ad;
            }

            /* í°íŠ¸ ì •ì˜ */
            @font-face {
                font-family: "Taenada";
                src: url("https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2210-2@1.0/Tenada.woff2")
                    format("woff2");
                font-weight: normal;
                font-style: normal;
                font-display: swap;
            }

            body {
                font-family: var(--font-main);
                background: linear-gradient(
                    135deg,
                    #a8d5e2 0%,
                    #f7d5d5 100%
                ); /* ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
                text-align: center;
                padding: 20px;
                margin: 0;
                min-height: 100vh;
            }

            /* --- ğŸ¨ ì‹œì‘ í™”ë©´ ìŠ¤íƒ€ì¼ --- */
            #startScreen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #f1faee;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                transition: opacity 0.7s ease-out; /* ì‚¬ë¼ì§€ëŠ” íš¨ê³¼ */
            }
            #startScreen.hidden {
                opacity: 0;
            }
            #pokeball {
                width: 100px;
                animation: bounce 1.5s infinite; /* ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ ì ìš© */
            }

            /* --- í†µí†µ íŠ€ëŠ” ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ --- */
            @keyframes bounce {
                0%,
                20%,
                50%,
                80%,
                100% {
                    transform: translateY(0);
                }
                40% {
                    transform: translateY(-40px);
                }
                60% {
                    transform: translateY(-20px);
                }
            }

            .header {
                margin-bottom: 30px;
            }

            .title {
                font-family: var(--font-pixel);
                font-size: 2.5em;
                color: var(--color-primary);
                text-shadow: 3px 3px 0 #fff, 6px 6px 0 rgba(0, 0, 0, 0.2);
                animation: float 3s ease-in-out infinite;
            }

            /* ë– ë‹¤ë‹ˆëŠ” ì• ë‹ˆë©”ì´ì…˜ */
            @keyframes float {
                0%,
                100% {
                    transform: translateY(0);
                }
                50% {
                    transform: translateY(-10px);
                }
            }

            .search-container {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
                margin-bottom: 30px;
            }
            #pokeId {
                padding: 10px;
                border-radius: 8px;
                border: 2px solid #fff;
                font-size: 16px;
                height: 24px;
                width: 150px;
                text-align: center;
            }
            #pokeBtn {
                font-family: var(--font-pixel);
                font-size: 14px;
                padding: 12px 20px;
                border-radius: 8px;
                border: none;
                background-color: var(--color-primary);
                color: white;
                cursor: pointer;
                transition: all 0.3s;
                box-shadow: 0 4px 0 var(--color-primary-dark);
            }
            #pokeBtn:hover {
                background-color: var(--color-primary-dark);
                transform: translateY(2px);
                box-shadow: 0 2px 0 var(--color-primary-dark);
            }

            /* ë¡œë”© ìŠ¤í”¼ë„ˆ ìŠ¤íƒ€ì¼ */
            .loader {
                border: 8px solid #f3f3f3;
                border-top: 8px solid var(--color-primary);
                border-radius: 50%;
                width: 60px;
                height: 60px;
                animation: spin 1s linear infinite;
                margin: 30px auto;
                display: none; /* í‰ì†Œì—” ìˆ¨ê¹€ */
            }
            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            /* í¬ì¼“ëª¬ ì •ë³´ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
            #pokeBox {
                display: inline-block;
                background: var(--color-card);
                backdrop-filter: blur(10px); /* ìœ ë¦¬ ê°™ì€ íš¨ê³¼ */
                border-radius: 20px;
                padding: 30px;
                box-shadow: var(--shadow);
                border: 1px solid rgba(255, 255, 255, 0.18);
                max-width: 320px;
                width: 100%;
                box-sizing: border-box;
                opacity: 0;
                transform: scale(0.9);
                transition: opacity 0.8s, transform 0.8s;
            }
            #pokeBox.visible {
                opacity: 1;
                transform: scale(1);
            }
            #pokeBox h3 {
                margin: 0 0 5px 0;
                font-size: 32px;
                color: #333;
            }
            #pokeBox h5 {
                margin: 0 0 20px 0;
                font-size: 18px;
                color: #555;
                font-weight: normal;
            }
            #pokeBox img {
                width: 180px;
                height: 180px;
                margin-bottom: 20px;
                cursor: pointer;
                transition: transform 0.5s ease-in-out;
                filter: drop-shadow(0px 8px 8px rgba(0, 0, 0, 0.2));
            }
            #pokeBox img:hover {
                transform: scale(1.15) rotate(5deg);
            }

            /* íƒ€ì… íƒœê·¸ ìŠ¤íƒ€ì¼ */
            .types-container {
                font-family: 'MemomentKkukkukk', 'Arial', sans-serif;
                display: flex;
                justify-content: center;
                gap: 10px;
                margin-bottom: 20px;
            }
            .type-tag {
                padding: 6px 14px;
                border-radius: 15px;
                color: white;
                font-size: 14px;
                font-weight: bold;
                text-transform: uppercase;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
            }
        </style>
    </head>
    <body>
        <div id="startScreen">
            <img
                src="https://upload.wikimedia.org/wikipedia/commons/5/53/Pok%C3%A9_Ball_icon.svg"
                alt="PokÃ© Ball"
                id="pokeball"
            />
        </div>

        <div id="mainContent" style="display: none">
            <header class="header">
                <h1 class="title">PokÃ©dex</h1>
            </header>
            <section>
                <div class="search-container">
                    <span>No.</span>
                    <input id="pokeId" type="number" min="1" />
                    <button id="pokeBtn">Search</button>
                </div>
            </section>
            <div class="loader" id="loader"></div>
            <section id="pokeBox"></section>
        </div>

        <script>
            // ì‹œì‘ í™”ë©´ ë¡œì§
            document.addEventListener("DOMContentLoaded", () => {
                const startScreen = document.getElementById("startScreen");
                const mainContent = document.getElementById("mainContent");

                // 2.5ì´ˆ í›„ì— ì‹œì‘ í™”ë©´ì„ ìˆ¨ê¸°ê³  ë©”ì¸ ì½˜í…ì¸ ë¥¼ í‘œì‹œ
                setTimeout(() => {
                    startScreen.classList.add("hidden");

                    // ì‚¬ë¼ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜ì´ ëë‚œ í›„ ì™„ì „íˆ ì œê±°
                    startScreen.addEventListener("transitionend", () => {
                        startScreen.style.display = "none";
                        mainContent.style.display = "block";

                        // ì´ì „ì— ê²€ìƒ‰í•œ í¬ì¼“ëª¬ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
                        const rawRecentPoke = localStorage.getItem("recent");
                        if (rawRecentPoke) {
                            renderPoke(JSON.parse(rawRecentPoke));
                        }
                    });
                }, 2500); // 2.5ì´ˆ ë™ì•ˆ ì‹œì‘ í™”ë©´ í‘œì‹œ
            });

            // --- ê¸°ì¡´ í¬ì¼“ëª¬ ë„ê° ë¡œì§ ---
            const pokeBtn = document.querySelector("#pokeBtn");
            const pokeIdInput = document.querySelector("#pokeId");
            const pokeBox = document.querySelector("#pokeBox");
            const loader = document.querySelector("#loader");

            // íƒ€ì…-ì´ëª¨ì§€ ë§¤í•‘
            const typeEmojis = {
                grass: "ğŸŒ¿",
                fire: "ğŸ”¥",
                water: "ğŸ’§",
                bug: "ğŸ›",
                normal: "â­",
                poison: "â˜ ï¸",
                electric: "âš¡",
                ground: "ğŸŒ",
                fairy: "ğŸ§š",
                fighting: "ğŸ¥Š",
                psychic: "ğŸ”®",
                rock: "ğŸ—¿",
                ghost: "ğŸ‘»",
                ice: "â„ï¸",
                dragon: "ğŸ‰",
                steel: "ğŸ›¡ï¸",
                dark: "ğŸŒ™",
                flying: "ğŸ•Šï¸",
            };

            // API ë°ì´í„° í˜¸ì¶œ í•¨ìˆ˜
            async function getPokemon(id) {
                if (!id) {
                    alert("í¬ì¼“ëª¬ No.ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }

                loader.style.display = "block";
                pokeBox.classList.remove("visible");

                try {
                    const [pokemonRes, speciesRes] = await Promise.all([
                        fetch(`https://pokeapi.co/api/v2/pokemon/${id}`),
                        fetch(`https://pokeapi.co/api/v2/pokemon-species/${id}`),
                    ]);

                    if (!pokemonRes.ok || !speciesRes.ok) {
                        throw new Error("í•´ë‹¹ No.ì˜ í¬ì¼“ëª¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    }

                    const data = await pokemonRes.json();
                    const data2 = await speciesRes.json();

                    const koNameObject = data2.names.find(
                        (v) => v.language.name === "ko"
                    );
                    const koName = koNameObject ? koNameObject.name : data.name;

                    const types = data.types.map((item) => item.type.name);

                    const pokeData = {
                        engName: data.name,
                        koName,
                        shape: data.sprites.front_default,
                        sound: data.cries.latest,
                        types,
                    };

                    renderPoke(pokeData);
                    localStorage.setItem("recent", JSON.stringify(pokeData));
                } catch (error) {
                    alert(error.message);
                    pokeBox.innerHTML = ""; // ì—ëŸ¬ ì‹œ ì¹´ë“œ ë‚´ìš© ë¹„ìš°ê¸°
                } finally {
                    loader.style.display = "none";
                }
            }

            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            pokeBtn.addEventListener("click", () =>
                getPokemon(pokeIdInput.value)
            );
            pokeIdInput.addEventListener("keyup", (event) => {
                if (event.key === "Enter") getPokemon(pokeIdInput.value);
            });

            // ë°ì´í„° í™”ë©´ì— ê·¸ë¦¬ê¸° í•¨ìˆ˜
            function renderPoke({
                engName,
                koName,
                types = [],
                shape,
                sound,
            }) {
                const typeHtml = types
                    .map(
                        (type) => `
                    <span class="type-tag" style="background-color: var(--type-${type})">
                        ${typeEmojis[type] || "â”"} ${type}
                    </span>
                `
                    )
                    .join("");

                pokeBox.innerHTML = `
                    <h3>${koName}</h3>
                    <h5>${engName}</h5>
                    <div class="types-container">${typeHtml}</div>
                    <img id="pokeImg" src="${shape}" alt="${koName}">
                    <audio id="pokeSound" src="${sound}"></audio>
                `;

                pokeBox.classList.add("visible");

                const pokeImg = document.querySelector("#pokeImg");
                const pokeSound = document.querySelector("#pokeSound");
                if (pokeImg && pokeSound) {
                    pokeImg.addEventListener("click", () => pokeSound.play());
                }
            }
        </script>
    </body>
</html>